[gcode_macro HomeArm]
gcode:
  {% if ('D' in params) and (params.D|float > 320) and (params.D|float >= 0) %}
    MANUAL_STEPPER STEPPER=brush_arm ENABLE=0                                                          ; Disables
    {% else %}
    {% if printer['tmc2209 manual_stepper brush_arm'].drv_status == None %}
      MANUAL_STEPPER STEPPER=brush_arm ENABLE=1 SPEED=10 SET_POSITION=20 MOVE=0 STOP_ON_ENDSTOP=1	; Homing with bump
      MANUAL_STEPPER STEPPER=brush_arm SPEED=10 MOVE=10
    {% endif %}
    {% if ('D' in params) and (params.D|float <= 320) and (params.D|float >= 0) %}
      MANUAL_STEPPER STEPPER=brush_arm SPEED=10 MOVE={params.D}                                       ; Moves
    {% endif %}
  {% endif %}